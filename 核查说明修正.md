# 代码核查说明修正版

## 离线环境下的潜在报错

### 1. WebCrypto API 限制（准确）
助记词种子与地址派生依赖 `crypto.subtle.importKey`/`deriveBits`/`digest` 等 WebCrypto 能力，这些 API 仅在安全上下文（HTTPS 或 localhost）中可用；在很多浏览器里用 `file://` 打开会得到 `TypeError` 并触发"地址生成失败"的错误提示。建议断网后通过 README 中推荐的本地服务器模式启动页面，以确保 WebCrypto 可用。

### 2. 外部词表加载（需要修正）
程序会尝试用 `fetch` 加载同目录下的 `english.txt`，若直接使用 `file://` 协议访问该文件路径会因为浏览器的 CORS 限制而失败。**代码内部的 `loadDefaultWordlist()` 函数会静默捕获异常（使用 `continue` 继续尝试下一个路径），不会输出错误信息到控制台。**只有在最外层的词表初始化 `try-catch` 块中发生异常时，才会在控制台输出错误信息。由于程序已内置完整的 BIP39 词表，因此即使外部文件加载失败，也会自动回退到内置词表，**通常不会在控制台看到任何错误信息**，不影响正常使用。

### 3. 复制地址功能（基本准确，建议补充）
复制地址按钮首先调用 `navigator.clipboard.writeText()`（需要安全上下文和剪贴板权限），若失败则自动降级为选中文本并调用 `document.execCommand('copy')`。如果两种方法都失败，会弹出 `alert("复制失败，请手动选择复制")` 提示。因此在离线场景下，**如果 clipboard API 失败但 `execCommand` 成功，不会弹出任何提示；只有当两种方法都失败时才会弹出提示**，不会导致页面崩溃。

## 已落实的安全修正

- 移除对 `esm.sh` CDN 的动态 `import()`，所有助记词、BIP84 地址推导逻辑改为使用内置实现，确保在完全离线的 `file://` 场景也不会请求外网脚本。
- 初始化流程改为预热本地实现，`DOMContentLoaded` 钩子只触发一次自检校验，不再尝试联网获取校验库。
- 其余安全措施保持不变：助记词、种子、私钥在使用后立即调用 `.fill(0)` 清零；不向 `localStorage`/`sessionStorage` 写入敏感数据；仅允许用户手动导入 `english.txt` 词表。

## Update Summary · 更新摘要

The generator now operates fully offline: all mnemonic creation and P2WPKH derivation logic rely on bundled implementations, and the startup routine only performs local self-checks. Clipboard fallbacks and memory wiping safeguards remain unchanged to prevent secret leakage.
该助记词与地址生成器现已可完全离线运行：全部助记词生成与 P2WPKH 推导逻辑均使用内置实现，初始化流程只执行本地自检。剪贴板降级方案与内存清零等安全措施保持不变，避免敏感信息泄露。

SegWit address outputs have been sanity-checked against two reference vectors, confirming the bundled derivation flow. However, users must still verify any offline-generated mnemonic and address with additional trusted offline wallet tools before receiving funds.
针对内置推导流程，我们已使用两个参考向量完成初步对照检查，确认生成的 SegWit 地址符合预期。但用户在离线生成助记词与收款地址后，仍须使用其他可信的离线钱包工具再次验证核对，确认无误后方可接收或转入资产。

## Disclaimer · 免责声明

This project is provided “as is” without warranties of any kind; the maintainers assume no liability for loss of funds, data corruption, or any damages arising from its use. Users bear full responsibility for independent verification, secure storage, and operational security of their mnemonics and derived addresses.
本项目按“现状”提供，不附带任何明示或暗示担保。维护者不对因使用本项目造成功能异常、资产损失或数据泄露承担责任。用户需自行完成验证、妥善保管助记词及地址，并对自身的安全操作承担全部责任。

